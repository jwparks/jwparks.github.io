---
title:  "ë ˆì´íŠ¸ë ˆì´ì‹±: ë¹›ê³¼ ê·¸ëž˜í”½ìŠ¤"
mathjax: true
layout: post
categories: Dev
---
2023ë…„ë„ ê²¨ìš¸í•™ê¸° ê³¼í•™ê³„ì‚° íŠ¸ë ˆì´ë‹ ì„¸ì…˜ì˜ ë‘ë²ˆì§¸ ì£¼ì œëŠ” ì»´í“¨í„°ë¥¼ ì´ìš©í•´ ë¹›ì„ ì¶”ì í•˜ëŠ” ê¸°ë²•ì¸ **Ray tracing** ìž…ë‹ˆë‹¤. 
ì´ë²ˆ ì£¼ì œëŠ” ì²« ì£¼ì°¨ ì£¼ì œë³´ë‹¤ ìˆ˜í•™ì ì¸ ìš”ì†Œë„ ë§Žê³ , ì´ë¥¼ ì»´í“¨í„°ë¥¼ ì´ìš©í•˜ì—¬ êµ¬í˜„í•˜ëŠ” ê²ƒë„ ì¡°ê¸ˆ ë” ì–´ë ¤ìš´ë°ìš”. 
ëŒ€ì‹  ê·¸ë§Œí¼ ë” ìž¬ë¯¸ìžˆëŠ” ì£¼ì œë¼ê³  ìƒê° í•©ë‹ˆë‹¤. 
ì´ë²ˆ ì£¼ì°¨ë¥¼ ìˆ˜í–‰í•˜ë©° ì—¬ëŸ¬ë¶„ì€ ì‹¤ì œë¡œ í˜„ëŒ€ ì»´í“¨í„° ê·¸ëž˜í”½ìŠ¤ì—ì„œ ë„ë¦¬ ì“°ì´ëŠ” ë Œë”ë§ ë°©ë²•ì¤‘ í•˜ë‚˜ì¸ ë ˆì´íŠ¸ë ˆì´ì‹±ì„ íŒŒì´ì¬ì„ ì´ìš©í•´ ì§ì ‘ êµ¬í˜„í•˜ê²Œ ë©ë‹ˆë‹¤.
ì´ë¥¼ êµ¬í˜„í•˜ëŠ” ê³¼ì •ì—ì„œ ì—¬ëŸ¬ë¶„ì€ ê³µê°„ ë²¡í„°ì˜ ê°œë…ê³¼ êµ¬í˜„ ë° ì‘ìš© ê·¸ë¦¬ê³  ê°ì²´ì§€í–¥ í”„ë¡œê·¸ëž˜ë°ì„ ì—°ìŠµ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

## Learning objectives
ì´ë²ˆ ì£¼ì°¨ì˜ í•™ìŠµ ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
- ê·¸ëž˜í”½ ë Œë”ë§ ë°©ë²•ì¸ ë ˆì´íŠ¸ë ˆì´ì‹±ì˜ ê°œë…ì„ ì´í•´í•©ë‹ˆë‹¤.
- ì»´í“¨í„° í”„ë¡œê·¸ëž˜ë°ì„ í†µí•´ ë¹›ê³¼ ê°ì²´ì˜ ìš”ì†Œë“¤ì„ ìˆ˜í•™ì ìœ¼ë¡œ ì •ì˜í•œ ê³µê°„ ë²¡í„°ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

ë˜í•œ ê³µì‹ì ì¸ í•™ìŠµ ëª©í‘œëŠ” ì•„ë‹ˆì§€ë§Œ ì´ë²ˆ ì£¼ì°¨ì˜ í•™ìŠµì„ ì§„í–‰í•˜ë©° ìˆ˜í•™ì ìœ¼ë¡œ ì •ì˜ë˜ëŠ” **ìˆ˜ì‹**ê³¼ ì´ë¥¼ ì»´í“¨í„°ë¡œ êµ¬í˜„í•˜ëŠ” **í”„ë¡œê·¸ëž˜ë° ì½”ë“œ** ì‚¬ì´ì˜ ê´€ê³„ê°€ ìµìˆ™í•´ì§ˆ ê±°ë¼ê³  ê¸°ëŒ€í•˜ê³  ìžˆìŠµë‹ˆë‹¤.  


## Introduction

ìš°ë¦¬ê°€ ì‹œê° ì‹œìŠ¤í…œì„ í†µí•´ ë¬¼ì²´ë¥¼ ë³¼ ìˆ˜ ìžˆëŠ” ì›ë¦¬ëŠ” ë¬´ì—‡ì¼ê¹Œìš”?
ë§Žì€ ë¶„ë“¤ì´ ë‹µì„ ìž˜ ì•Œê³  ê³„ì‹œê² ì§€ë§Œ ìš°ë¦¬ëŠ” ëˆˆìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ë¹›, ì¦‰ ê´‘ì„ ì„ í†µí•´ì„œ ë¬¼ì²´ë¥¼ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
íƒœì–‘, ì „êµ¬ ë“± ê´‘ì›(Light source)ì—ì„œ ë‚˜ì˜¨ ë¹›ì´ ë¬¼ì²´ì— ë°˜ì‚¬ë˜ê³ , ë¬¼ì²´ê°€ ê°€ì§„ ë¬¼ë¦¬ì ì¸ íŠ¹ì„±ì— ë”°ë¼ ê´‘ì„ ì˜ íŒŒìž¥ì´ ë°”ë€Œê³ , ë°”ë€ ê´‘ì„ ì˜ íŒŒìž¥ì„ í†µí•´ ìš°ë¦¬ëŠ” ë¬¼ì²´ë¥¼ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ë ˆì´íŠ¸ë ˆì´ì‹±, ìš°ë¦¬ë§ë¡œ ê´‘ì„ ì¶”ì  ê¸°ë²•ì€ ì»´í“¨í„° ê·¸ëž˜í”½ì˜ ë Œë”ë§ ê¸°ë²•ì¤‘ í•˜ë‚˜ë¡œ, 
ìš°ë¦¬ê°€ ë¹›ì„ í†µí•´ ë¬¼ì²´ë¥¼ ë³¼ ìˆ˜ ìžˆëŠ” ì›ë¦¬ë¥¼ ì»´í“¨í„°ë¥¼ ì´ìš©í•´ ì§ê´€ì ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê¸°ë²•ìž…ë‹ˆë‹¤.
ì‹¤ì œë¡œ ë‹¤ë¥¸ ì ì´ ìžˆë‹¤ë©´ ê´‘ì›ì—ì„œ ë‚˜ì˜¨ ë¹›ì„ ì¶”ì í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì´ë¯¸ì§€ë¡œ ë“¤ì–´ì˜¤ëŠ” ë¹›ì„ ì—­ì¶”ì  í•˜ëŠ” ê¸°ë²•ì´ë¼ëŠ” ì°¨ì´ê°€ ìžˆìŠµë‹ˆë‹¤.
ë‹¤ë¥¸ ë Œë”ë§ ê¸°ë²• ëŒ€ë¹„ ë ˆì´íŠ¸ë ˆì´ì‹±ì˜ ìž¥ì ì€ **ë§¤ìš° í˜„ì‹¤ì ì¸ ê·¸ëž˜í”½**ì„ ë Œë”ë§ í•  ìˆ˜ ìžˆë‹¤ëŠ” ìž¥ì ì´ ìžˆìŠµë‹ˆë‹¤.
ë‹¹ì—°ížˆ ì‹¤ì œ í˜„ì‹¤ì˜ ë¬¼ë¦¬ê³„ì—ì„œ ì¼ì–´ë‚˜ëŠ” ë¹›ì˜ ë°˜ì‚¬ë¥¼ ê°€ìž¥ ì§ê´€ì ìœ¼ë¡œ êµ¬í˜„í•œ ê¸°ë²•ì´ê¸° ë•Œë¬¸ì— í˜„ì‹¤ì ì¸ ê·¸ëž˜í”½ì„ ë§Œë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
ë°˜ë©´ ë‹¨ì ì€ ì´ë¯¸ì§€ë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìˆ˜ ë§Žì€ ê´‘ì„  ë‹¤ë°œì„ ì¶”ì í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ê·¹ë„ë¡œ ë†’ì€ ì»´í“¨í„° ìžì›ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤. 
ê·¸ëž˜ì„œ ë ˆì´íŠ¸ë ˆì´ì‹±ì€ 1980ë…„ëŒ€ì— ì œì•ˆëœ ì»´í“¨í„° ê·¸ëž˜í”½ìŠ¤ ê¸°ë²•ì´ì§€ë§Œ, ê·¸ë™ì•ˆì€ ë§¤ìš° ì œí•œëœ í™˜ê²½ì—ì„œë§Œ í™œìš©ë˜ì–´ ì™”ìŠµë‹ˆë‹¤. 
ê·¸ëž˜í”½ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ë Œë”ë§í•´ì•¼ í•˜ëŠ” ë¹„ë””ì˜¤ ê²Œìž„ ë“±ì—ì„œëŠ” ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ê³ , ë¯¸ë¦¬ ë Œë”ë§ì„ í•´ì„œ ë³´ì—¬ ì¤„ ìˆ˜ ìžˆëŠ” ì˜í™”, ì• ë‹ˆë©”ì´ì…˜ ë“±ì—ì„œ ì£¼ë¡œ í™œìš©ë˜ì–´ ì™”ìŠµë‹ˆë‹¤.
í•˜ì§€ë§Œ í˜„ëŒ€ ì»´í“¨í„° í•˜ë“œì›¨ì–´ì˜ ë°œì „ì„ í†µí•´ ê°€ì •ìš© ì»´í“¨í„°ì— ë“¤ì–´ê°€ëŠ” ê·¸ëž˜í”½ì¹´ë“œë“¤ì´ ë ˆì´íŠ¸ë ˆì´ì‹± ì „ìš© ì§ì ‘íšŒë¡œì¸ RT ì½”ì–´ë¥¼ íƒ‘ìž¬í•˜ë©°
ì‹¤ì‹œê°„ ë Œë”ë§ì„ í•„ìš”ë¡œ í•˜ëŠ” ë¹„ë””ì˜¤ ê²Œìž„ ë“±ì—ì„œë„ ì œí•œì ìœ¼ë¡œ ë ˆì´íŠ¸ë ˆì´ì‹± ê¸°ë²•ì´ í™œìš©ë˜ê³  ìžˆìŠµë‹ˆë‹¤. 
ì•„ë§ˆ ì»´í“¨í„°ë¥¼ ìž˜ ëª¨ë¥´ì‹œëŠ” ë¶„ë“¤ë„ ê·¸ëž˜í”½ì¹´ë“œ ëª¨ë¸ëª…ì´ RTX3070ì´ë‹¤, RTX4080ì´ë‹¤ ì´ëŸ° ë§ë“¤ì„ ë“¤ì–´ ë³´ì…¨ì„ í…ë°ìš”, ì´ë ‡ê²Œ RTX ì´ë¦„ì„ ë‹¬ê³  ìžˆëŠ” ê·¸ëž˜í”½ì¹´ë“œë“¤ì´ ë°”ë¡œ RT ì½”ì–´ë¥¼ ë‚´ìž¥í•˜ê³  ìžˆëŠ” ê·¸ëž˜í”½ì¹´ë“œë“¤ ìž…ë‹ˆë‹¤.

![0](https://i.ibb.co/m6cnhDy/Control-RTX-Comparison-6.jpg)

ì´ˆë‹¹ ìˆ˜ì‹­ìž¥ì˜ í”„ë ˆìž„ì„ ë Œë”ë§ í•˜ëŠ” ë¹„ë””ì˜¤ ê²Œìž„ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì‹¤ì‹œê°„ ë ˆì´íŠ¸ë ˆì´ì‹± ê¸°ë²•ì€ ì•„ì§ ë¶€ì¡±í•œ ì ì´ ë§ŽìŒì—ë„ ë¶ˆêµ¬í•˜ê³ ,
2019ë…„ ì¶œì‹œëœ ë¹„ë””ì˜¤ ê²Œìž„ì¸ "Control"ì—ì„œ ê¸°ì¡´ ë Œë”ë§ ê¸°ë²•(ì™¼ìª½)ê³¼ ì‹¤ì‹œê°„ ë ˆì´íŠ¸ë ˆì´ì‹±(ì˜¤ë¥¸ìª½)ì„ ë¹„êµí•´ ë³´ë©´ ë¹›ì˜ ë°˜ì‚¬ì™€ ì‚¬ë¬¼ì˜ ê·¸ë¦¼ìžì—ì„œ í™•ì—°í•œ ì°¨ì´ê°€ ë‚˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
ì´ì²˜ëŸ¼ ë ˆì´íŠ¸ë ˆì´ì‹±ì€ ë¹›ì´ ë°˜ì‚¬ë˜ì–´ ìƒê¸°ëŠ” ìƒ, ê°€ë ¤ì„œ ìƒê¸°ëŠ” ê·¸ë¦¼ìž ë“±ì„ ë§¤ìš° í˜„ì‹¤ì ìœ¼ë¡œ ë Œë”ë§ í•  ìˆ˜ ìžˆëŠ” ê¸°ë²•ìž…ë‹ˆë‹¤. 

ìµœê·¼ì—” ë§Žì€ ê²Œìž„ ì—”ì§„ê³¼ ë Œë”ë§ ì—”ì§„ ë“±ì—ì„œ ë ˆì´íŠ¸ë ˆì´ì‹±ì„ ê¸°ë³¸ ì˜µì…˜ìœ¼ë¡œ ì œê³µí•˜ê³  ìžˆì–´ ì†ì‰½ê²Œ êµ¬í˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ì§€ë§Œ ìš°ë¦¬ëŠ” `python`ê³¼ `numpy`ë“± ê¸°ë³¸ì ì¸ ê³¼í•™ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬ë§Œì„ ì´ìš©í•˜ì—¬ ì‹¤ì œ ë ˆì´íŠ¸ë ˆì´ì‹±ì„ ë°‘ë°”ë‹¥ë¶€í„° êµ¬í˜„í•´ ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤. 

> Quiz 1. ë ˆì´íŠ¸ë ˆì´ì‹± ê¸°ë²•ì€ ì™œ ê´‘ì›ìœ¼ë¡œë¶€í„° ë‚˜ì˜¤ëŠ” ê´‘ì„ ì„ ì§ì ‘ ì¶”ì í•˜ì§€ ì•Šê³ , ì´ë¯¸ì§€ë¡œ ë“¤ì–´ì˜¤ëŠ” ë¹›ì„ ì—­ì¶”ì  í• ê¹Œìš”?

## Pythonì„ ì´ìš©í•œ ë ˆì´íŠ¸ë ˆì´ì‹± êµ¬í˜„
### ë¬¸ì œì™€ ì¢Œí‘œê³„ë¥¼ ì •ì˜í•˜ê¸°
í¥ë¯¸ë¡œìš´ ì£¼ì œê°€ ì •í•´ ì¡Œìœ¼ë‹ˆ ì´ì œ ë¬¸ì œì™€ ì¢Œí‘œê³„ë¥¼ ì •ì˜í•  ì°¨ë¡€ ìž…ë‹ˆë‹¤. ìš°ë¦¬ëŠ” ê¶ê·¹ì ìœ¼ë¡œ ë ˆì´íŠ¸ë ˆì´ì‹± ê¸°ë²•ì„ ì´ìš©í•˜ì—¬ 2D ì´ë¯¸ì§€ë¥¼ ë Œë”ë§ í•˜ê¸°ë¥¼ ì›í•©ë‹ˆë‹¤. 
2D ì´ë¯¸ì§€ë¥¼ ë Œë”ë§ í•œë‹¤ëŠ” ì˜ë¯¸ëŠ”, ì´ë¯¸ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” í”½ì…€ë“¤ì˜ ìƒ‰ì„ "ì ì ˆížˆ" ì¹ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 
ê·¸ë¦¬ê³  ìš°ë¦¬ëŠ” ê° í”½ì…€ë“¤ì˜ ìƒ‰ì´ ê·¸ í”½ì…€ë¡œ ë“¤ì–´ì˜¨ ê´‘ì„ ìœ¼ë¡œë¶€í„° ì •ì˜ë  ê²ƒì´ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œê³  ìžˆìŠµë‹ˆë‹¤.

![1](https://i.ibb.co/nBbSDkp/1.png)

ìœ„ ê·¸ë¦¼ì—ëŠ” 2D ì´ë¯¸ì§€(í”„ë ˆìž„)ì¸ `Scene`ì˜ í”½ì…€ $ P(a) $, $P(b)$, $P(c)$ë¥¼ ê°ê° í†µê³¼í•˜ëŠ” ì„¸ê°œì˜ ê´‘ì„  $R(a)$, $R(b)$, $R(c)$ì´ ê·¸ë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤.
ê´‘ì„  $R(a)$ì˜ ê²½ìš° ì •ì˜ëœ ë¬¼ì²´ì¸ íŒŒëž€ìƒ‰ êµ¬ì—ì„œ ë°˜ì‚¬ë˜ì–´ ê´‘ì›ì„ í–¥í•˜ê³  ìžˆìŠµë‹ˆë‹¤. ì´ ê²½ìš° ìš°ë¦¬ëŠ” í”½ì…€ $P(a)$ë¥¼ ì–´ë–¤ ìƒ‰ìœ¼ë¡œ ì¹ í•´ì•¼ í• ê¹Œìš”? 
ê´‘ì„  $R(a)$ê°€ íŒŒëž€ìƒ‰ êµ¬ì— ë‹¿ëŠ” ë¶€ë¶„ì€ ìƒëŒ€ì ìœ¼ë¡œ ë°ì„ ê²ƒì´ê¸° ë•Œë¬¸ì— ìš°ë¦¬ëŠ” ë°ì€ ìƒ‰ì„ ì¹ í•´ì£¼ë©´ ë©ë‹ˆë‹¤. ê·¸ë¦¼ì—ì„œëŠ” $P(a)$ì˜ ìƒ‰ì´ í°ìƒ‰ìœ¼ë¡œ í‘œê¸° ë˜ì–´ ìžˆìŠµë‹ˆë‹¤. 
ë§ˆì°¬ê°€ì§€ë¡œ í”½ì…€ `$(b)$ë¥¼ í†µê³¼í•˜ëŠ” ê´‘ì„  $R(b)$ëŠ” ë¹›ì´ ë¬¼ì²´ì— ë‹¿ê³  ë¹ˆ ê³µê°„ ì–´ë”˜ê°€ë¡œ ë°˜ì‚¬ê°€ ë  ê²ƒìž…ë‹ˆë‹¤. ê´‘ì›ì„ ì§ì ‘ì ìœ¼ë¡œ í–¥í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— í”½ì…€ $P(b)$ëŠ” ë¬¼ì²´ì˜ ìƒ‰ì¸ íŒŒëž€ìƒ‰ì„ ë„ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤.
ë§ˆì§€ë§‰ìœ¼ë¡œ í”½ì…€ $P(c)$ë¥¼ ì§€ë‚˜ëŠ” ê´‘ì„  $R(c)$ëŠ” ë°”ë‹¥ ë©´ì—ì„œ ë°˜ì‚¬ë˜ì–´ ì–´ë”˜ê°€ë¡œ ë°˜ì‚¬ê°€ ë  ê²ƒì´ì§€ë§Œ, ê´‘ì›ì´ ë¬¼ì²´ì— ê°€ë ¤ì ¸ ìžˆìŠµë‹ˆë‹¤. 
ì´ ê²½ìš°ì— ë¬¼ì²´ì˜ ê·¸ë¦¼ìžê°€ ìƒê¸°ê²Œ ë˜ëŠ”ë°, ê´‘ì„  $R(c)$ëŠ” ê·¸ë¦¼ìžê°€ ìƒê¸°ëŠ” ìœ„ì¹˜ë¥¼ í–¥í•˜ê³  ìžˆê¸° ë•Œë¬¸ì— í”½ì…€ $P(c)$ëŠ” ì–´ë‘ìš´ ìƒ‰ì„ ë„ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤.

ì´ë ‡ê²Œ ë ˆì´íŠ¸ë ˆì´ì‹±ì„ í†µí•œ ë Œë”ë§ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ì„  ìš°ë¦¬ì˜ ì‹œì (ì¹´ë©”ë¼)ë¡œë¶€í„° `Scene`ì˜ í”½ì…€ì„ í†µê³¼í•˜ëŠ” ê° ê´‘ì„ ë“¤ì´ ê²°êµ­ ë¬¼ì²´ì˜ ì–´ë–¤ ë¶€ë¶„ì— ë¶€ë”ªížˆëŠ”ì§€ë¥¼ ê³„ì‚°í•˜ê³ , 
ì´ë¥¼ í†µí•´ ê° í”½ì…€ì˜ ìƒ‰ì„ ê²°ì •í•˜ë©´ ë©ë‹ˆë‹¤. ë¬¸ì œë¥¼ ì •ì˜í•´ ë³´ë‹ˆ ì •ë§ ê°„ë‹¨í•˜ì£ ?

### ê´‘ì„  ë²¡í„°
ìš°ë¦¬ëŠ” ì´ë¯¸ì§€ë¥¼ êµ¬ì„±í•˜ëŠ” í”½ì…€ì˜ ìˆ˜ ë§Œí¼ ê´‘ì„ ì„ ì¶”ì  í•´ì•¼ í•©ë‹ˆë‹¤. 
ë§Œì•½ `1920Ã—1080` í•´ìƒë„ì˜ ì´ë¯¸ì§€(`Scene`) í•œ ìž¥ì„ ë Œë”ë§ í•œë‹¤ê³  ê°€ì •í•˜ë©´ ì´ 2,073,600ê°œì˜ ê´‘ì„ ì„ ì •ì˜í•˜ê³  ì¶”ì í•´ì•¼ í•©ë‹ˆë‹¤.
ì´ëŸ¬í•œ ê´‘ì„ ë“¤ì€ ì‹œìž‘ì ê³¼ ë°©í–¥ì´ ìžˆëŠ” ê°ì²´ë“¤ë¡œ ì •ì˜í•˜ê³  êµ¬í˜„ í•  ìˆ˜ ìžˆëŠ”ë°ìš”. ë¬¸ì œëŠ” ê° ê´‘ì„ ë“¤ì´ í–¥í•˜ëŠ” ë°©í–¥ì´ ëª¨ë‘ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒ ìž…ë‹ˆë‹¤.

ê·¸ëž˜ì„œ ìš°ë¦¬ëŠ” ì‹œì (ì¹´ë©”ë¼ì˜ ìœ„ì¹˜)ìœ¼ë¡œë¶€í„° 2D ì´ë¯¸ì§€ì˜ ê° í”½ì…€ë“¤ì„ í†µê³¼í•˜ëŠ” ê´‘ì„ ì˜ ê³µê°„ ë²¡í„°ì˜ ë°©í–¥ì„ ê³„ì‚°í•´ì•¼ í•©ë‹ˆë‹¤.
ì¹´ë©”ë¼ì˜ ìœ„ì¹˜ $\vec{C_0}(x,y,z)$ì™€ ë°©í–¥ $\vec{C_d}(x,y,z)$, ì¹´ë©”ë¼ì˜ ì‹œì•¼ê°($ \text{FOV}(\theta) $)ì´ ì •í•´ì§€ë©´ ê° í”½ì…€ì„ í†µê³¼í•˜ëŠ” ê´‘ì„ ë“¤ì˜ ê³µê°„ ë²¡í„°ì˜ ë°©í–¥ì„ ê³„ì‚° í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
ë¬¼ë¡  ì¹´ë©”ë¼ëŠ” ë Œì¦ˆë¥¼ í†µê³¼í•˜ëŠ” íšŒì „ì¶•ì„ ì¤‘ì‹¬ìœ¼ë¡œ íšŒì „(`roll`)ì´ ê°€ëŠ¥í•œë°, ì´ ê²½ìš°ëŠ” ì¹´ë©”ë¼ì˜ ìœ„ìª½ì´ í•­ìƒ $\hat{z}(0,0,1)$ ë°©í–¥ì„ í–¥í•œë‹¤ê³  ê°€ì •í•˜ì—¬ ì¹´ë©”ë¼ì˜ `roll` ë°©í–¥ íšŒì „ì€ ê³ ë ¤í•˜ì§€ ì•Šê² ìŠµë‹ˆë‹¤.

![2](https://i.ibb.co/XsWVXV5/2.png)

ì¹´ë©”ë¼ë¡œë¶€í„° ë»—ì–´ë‚˜ê°€ëŠ” ê´‘ì„  ë²¡í„°ë¥¼ í”„ë¡œê·¸ëž˜ë°ìœ¼ë¡œ êµ¬í˜„í•˜ê¸° ì „ì— ë¨¼ì € ì‚¬ê³  ì‹¤í—˜ì„ í†µí•´ ì–´ë–¤ ëª¨ìŠµì˜ ì´ë¯¸ì§€ê°€ ë Œë”ë§ ë ì§€ ì˜ˆìƒ í•´ ë³´ê² ìŠµë‹ˆë‹¤. 
**í…… ë¹ˆ ê³µê°„ ê°€ìš´ë° ì•„ì£¼ ë„“ì€ í‰ë©´ì´ ìžˆê³ , ìš°ë¦¬ê°€ ê·¸ í‰ë©´ ìœ„ì— ì„œì„œ ì¹´ë©”ë¼ë¡œ ì‚¬ì§„ì„ ì°ì–´ ë³¸ë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.**
ê·¸ëŸ¼ ì–´ë–¤ ì‚¬ì§„ì´ ì°í˜”ì„ê¹Œìš”? ì•„ë§ˆ ì˜ˆì‹œë¡œ ê°€ì ¸ì˜¨ ì˜¤ë¥¸ìª½ ë‹¬ ì‚¬ì§„ì²˜ëŸ¼ ë©€ë¦¬ê¹Œì§€ ë»—ì–´ìžˆëŠ” ì§€í‰ì„ ì´ ë³´ì´ëŠ” ì‚¬ì§„ì´ ì´¬ì˜ë˜ì—ˆì„ ê²ƒìž…ë‹ˆë‹¤. 
ìˆ˜í‰ì„ ì´ ì‚¬ì§„ì˜ ì • ê°€ìš´ë°ì— ìžˆë‹¤ê³  í•´ ë³´ë©´ ì´ë¯¸ì§€ì˜ ì ˆë°˜ ì•„ëž˜ìª½ì˜ í”½ì…€ì„ í†µê³¼í•˜ëŠ” ê´‘ì„  ë²¡í„°ë“¤ì€ í‰ë©´(ì˜ˆì‹œì—ì„  ë‹¬ í‘œë©´)ì„ í–¥í• í…Œê³ , 
ì´ë¯¸ì§€ì˜ ì ˆë°˜ ìœ„ìª½ì˜ í”½ì…€ì„ í†µê³¼í•˜ëŠ” ê´‘ì„  ë²¡í„°ë“¤ì€ ì–´ë””ì—ë„ ë¶€ë”ªížˆì§€ ì•Šì€ì±„ í…… ë¹ˆ ê³µê°„(ì˜ˆì‹œì—ì„  ìš°ì£¼ ê³µê°„)ìœ¼ë¡œ ë‚ ì•„ê°€ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤.

ê·¸ë ‡ë‹¤ë©´ ê° í”½ì…€ë“¤ì€ ì–´ë–¤ ìƒ‰ì„ ê°€ì§ˆê¹Œìš”? í‰ë©´ì— ë¶€ë”ªížˆëŠ” ë¹›ì— í•´ë‹¹í•˜ëŠ” í”½ì…€ $P_1$ì€ í‰ë©´ì˜ ìƒ‰(í°ìƒ‰)ì„ ê°€ì§€ê²Œ ë  ê²ƒì´ê³ , 
ì–´ë””ì—ë„ ë¶€ë”ªížˆì§€ ì•Šê³  í…… ë¹ˆ ê³µê°„ìœ¼ë¡œ ë‚ ì•„ê°€ëŠ” ë¹›ì— í•´ë‹¹í•˜ëŠ” í”½ì…€ ($P_2$)ëŠ” ë„ë‹¬í•œ ë¹›ì´ ì—†ìœ¼ë¯€ë¡œ ê²€ì€ ìƒ‰ì„ ê°€ì§€ê²Œ ë  ê²ƒìž…ë‹ˆë‹¤. 
ì´ì œ ì‹¤ì œë¡œ ì´ ì‚¬ê³  ì‹¤í—˜ì„ ê·¸ëŒ€ë¡œ ì»´í“¨í„° í”„ë¡œê·¸ëž˜ë°ì„ í†µí•´ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤. ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![3](https://i.ibb.co/whHDrDx/3.png)

ê·¸ëƒ¥ ì•„ëž˜ ì ˆë°˜ í°ìƒ‰ìœ¼ë¡œ ì¹ í•œê±° ì•„ë‹ˆëƒêµ¬ìš”? ë†€ëžê²Œë„ ì•„ë‹™ë‹ˆë‹¤... ðŸ˜…

ì§€ê¸ˆ ë³´ê³  ê³„ì‹  `1920Ã—1080` í•´ìƒë„ì˜ ì´ë¯¸ì§€(`Scene`) í•œ ìž¥ì„ ë Œë”ë§í•˜ê¸° ìœ„í•´ ì¹´ë©”ë¼ë¡œë¶€í„° ë»—ì–´ë‚˜ê°€ëŠ” 2,073,600ê°œì˜ ê´‘ì„ ì„ ì •ì˜í•˜ê³ , 
í•´ë‹¹ ê´‘ì„ ë“¤ì´ ê°ê° ì–´ë””ì— ë¶€ë”ªížˆëŠ”ì§€ë¥¼ ì „ë¶€ ì¶”ì í•˜ì—¬ ê³„ì‚°ëœ ì´ë¯¸ì§€ìž…ë‹ˆë‹¤. ì´ ì´ë¯¸ì§€ í•œ ìž¥ì„ ë Œë”ë§ í•˜ëŠ”ë° ì œ ë…¸íŠ¸ë¶ìœ¼ë¡œ 1ë¶„ 20ì´ˆ ì •ë„ê°€ ì†Œìš”ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ì œ ì½”ë“œë¥¼ ë³´ë©´ì„œ ë ˆì´íŠ¸ë ˆì´ì‹± ê¸°ë²•ì„ ì´í•´í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ë¨¼ì € `Scene`ì„ êµ¬ì„±í•˜ëŠ” `object`ë“¤ì„ ì •ì˜í•´ ë³´ê² ìŠµë‹ˆë‹¤. ì•žìœ¼ë¡œ ë‹¤ì–‘í•œ ë¬¼ì²´ë“¤ì˜ í´ëž˜ìŠ¤ë¥¼ ì •ì˜í•  ê²ƒ ê°™ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í‰ë©´ì„ ë‚˜íƒ€ë‚´ëŠ” `Plane()` í´ëž˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.
êµ¬í˜„ ë°©ì‹ì— ë”°ë¼ ë‹¤ë¥¸ë° ì €ëŠ” ê³„ì‚°ì„ ë‹´ë‹¹í•˜ëŠ” ë ˆì´íŠ¸ë ˆì´ì‹± ì•Œê³ ë¦¬ì¦˜ì€ ëª¨ë‘ `Scene()` í´ëž˜ìŠ¤ì— ë„£ì„ ê²ƒì´ê¸° ë•Œë¬¸ì—, 
`Plane()` í´ëž˜ìŠ¤ì—ì„œëŠ” ì´ê²Œ ì–´ë–¤ í‰ë©´ì¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ ì¤„ ìˆ˜ ìžˆëŠ” ì •ë³´ë§Œ ë„£ì–´ ì£¼ë©´ ì¶©ë¶„ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.
3ì°¨ì› ê³µê°„ì—ì„œ í‰ë©´ì€ í•œ ì ê³¼ í‰ë©´ì— ìˆ˜ì§ì¸ ë°©í–¥ë²¡í„°(ì´ë¥¼ ë³´í†µ ë…¸ë§ë²¡í„° ë¼ê³  í•©ë‹ˆë‹¤)ë¡œ ì •ì˜ í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. 
ê·¸ëž˜ì„œ `Plane()` í´ëž˜ìŠ¤ ì†ì„±ìœ¼ë¡œ `.position`, `.normal` ê·¸ë¦¬ê³  í‰ë©´ì˜ ìƒ‰ì„ ì •ì˜í•˜ëŠ” `.color` ì†ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤. 

{% highlight python %}
class Plane():
    def __init__(self, position, normal, color):
        self.type = 'plane'
        self.position = np.array(position)
        self.normal = normalize(np.array(normal))
        self.color = np.array(color)
{% endhighlight %}

ì´ì œ `Plane()` í´ëž˜ìŠ¤ë¥¼ ì´ìš©í•˜ì—¬ ì  $P=(0,0,-1)$ì„ ì§€ë‚˜ê³ , $\hat{z}$ ë°©í–¥ì— ìˆ˜ì§(ì¦‰ ë…¸ë§ë²¡í„°ê°€ $N=(0,0,1)$)ì¸ í°ìƒ‰ í‰ë©´ì„ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.
ë§Œë“¤ì–´ì§„ í°ìƒ‰ í‰ë©´ `white_plane`ì„ `1920Ã—1080` í•´ìƒë„ì˜ `Scene`ì— ë„£ê³ , `Scene`ì„ ë Œë”ë§ í•˜ê¸° ìœ„í•œ ì‹œì (ì¹´ë©”ë¼)ì„ ì •ì˜í•©ë‹ˆë‹¤.
ì¹´ë©”ë¼ëŠ” ê³µê°„ìƒì—ì„œ ì›ì ($C=(0,0,0)$)ì— ì¡´ìž¬í•˜ê³ , $\hat{y}$ ì¶•ì„ ë°”ë¼ë³´ê³ ($D=(0,0,1)$) ìžˆìŠµë‹ˆë‹¤.  

{% highlight python %}
white_plane = Plane(position=(0,0,-1), normal=(0,0,1), color=(1,1,1))

scene = Scene(width=1920, height=1080, objects=[white_plane])
scene.add_camera(camera_position=(0,0,0), camera_direction=(0,1,0))
scene.get_image()
scene.draw_image()
{% endhighlight %}

ì´ì œ ì§ê´€ì ìœ¼ë¡œ ê° ê°ì²´ë“¤ì´ ì–´ë–»ê²Œ ì–´ìš¸ë¦¬ëŠ”ì§€ ì´í•´í•˜ì…¨ì„ ê±°ë¼ê³  ìƒê° ë©ë‹ˆë‹¤. `scene` ê°ì²´ë¥¼ ë§Œë“  í›„, 
í•´ë‹¹ ê°ì²´ì— ì‚¬ë¬¼(ì—¬ê¸°ì„œëŠ” í°ìƒ‰ í‰ë©´)ê³¼ ì¹´ë©”ë¼ë¥¼ ë°°ì¹˜í•˜ê³ , í•´ë‹¹ ì¹´ë©”ë¼ë¡œ ì‚¬ì§„ì„ ì°ê³ , ì´ë¯¸ì§€ë¥¼ ì¶œë ¥í•œë‹¤ê³  ìƒê°í•˜ì‹œë©´ ì§ê´€ì ì¼ê²ƒ ê°™ìŠµë‹ˆë‹¤.

`Scene()` í´ëž˜ìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

{% highlight python %} 
def normalize(vector):
    return vector / np.linalg.norm(vector)

class Scene():
    def __init__(self,
                 width,
                 height,
                 objects):
        self.w = np.array(width)
        self.h = np.array(height)
        self.ratio = width / height
        self.objects = objects
        self.image = np.zeros((height, width, 3))

    def add_camera(self,
                   camera_position,
                   camera_direction,
                   depth_limit = 3):
        self.Co = np.array(camera_position)
        self.Cd = normalize(np.array(camera_direction) - self.Co)
        self.Cu = np.array([0,0,1])
        self.Cr = normalize(np.cross(self.Cd, self.Cu))
        self.hFOV = 75
        self.depth = depth_limit
        self.pixel_w = 2*np.tan(np.radians(self.hFOV/2)) / self.w
        self.pixel_h = self.pixel_w

    def get_intersection(self, ray_origin, ray_direction, object):
        if object.type == 'plane':
            # Ray-Plane intersection
            O = ray_origin
            D = ray_direction
            P = object.position
            N = object.normal

            t = np.dot((P-O), N) / np.dot(D, N)
            if t > 10e4 or t < 0:
                distance = np.inf
            else:
                distance = t
            intersection = O + distance*ray_direction
            return distance, intersection

    def trace_ray(self, ray_origin, ray_direction):
        # Step 1: Find the closest object
        max_distance = np.inf
        closest_object = None
        M = None # closest intersection point
        for o, obj in enumerate(self.objects):
            distance, intersection = self.get_intersection(ray_origin, ray_direction, obj)
            if distance < max_distance:
                max_distance = distance
                closest_object = obj
                M = intersection
        if max_distance == np.inf: # no object
            return np.zeros(3)

        # Step 2: Get properties of the closest object
        color = closest_object.color
        # Step 3:
        return color

    def get_image(self):
        for x in range(self.w):
            for y in range(self.h):
                dx = self.pixel_w * (x - self.w/2)
                dy = - self.pixel_h * (y - self.h/2)

                O = self.Co # Origin of ray
                R = normalize(self.Cd + dx*self.Cr + dy*self.Cu) # Direction of ray

                color = self.trace_ray(O, R)
                self.image[y,x] = np.clip(color, 0, 1)

    def draw_image(self, dpi=300):
        plt.figure(dpi=dpi)
        plt.imshow(self.image)
        plt.show()
{% endhighlight %}


